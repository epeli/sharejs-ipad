<!doctype html>
<html>
  <head>
    <title>iPad bug</title>
  </head>
  <body>
    <div id=status>Loading...</div>
    <h1>iPad ShareJS bug</h1>
    <a href="https://github.com/epeli/sharejs-ipad">github</a>

    <h2>Before ShareJS:</h2>
    <div id=before-sharejs></div>

    <h2>After ShareJS:</h2>
    <div id=after-sharejs></div>


  <script src="/channel/bcsocket.js"></script>
  <script src="/share/share.uncompressed.js"></script>
  <script src="/share/json.uncompressed.js"></script>
  <script>
    document.getElementById("before-sharejs").innerHTML = '<img src="/before' + parseInt(Math.random()*100000) + '/image.png" >';
    sharejs.open("mydoc", "json", function(err, doc){

      setTimeout(function(){
        if (err) {
          return document.getElementById("status").innerHTML = "Failed to load ShareJS!";
        }
        document.getElementById("status").innerHTML = "ShareJS loaded.!";
        document.getElementById("after-sharejs").innerHTML = '<img src="/after' + parseInt(Math.random()*100000) + '/image.png" >';
      }, 500);

    });

  </script>

  </body>
</html>
